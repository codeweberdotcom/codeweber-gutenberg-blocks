(()=>{"use strict";var e,t={180:(e,t,l)=>{const n=window.wp.blocks,o=window.wp.i18n,r=JSON.parse('{"apiVersion":3,"name":"codeweber-blocks/tables","version":"0.1.0","title":"Tables","category":"codeweber-gutenberg-elements","icon":"editor-table","description":"Bootstrap 5 tables. Supports Simple, Dark, Striped, Bordered, Borderless, Hoverable, and Responsive styles.","keywords":["table","tables","bootstrap","data"],"supports":{"html":false,"customClassName":true,"anchor":true},"attributes":{"sourceMode":{"type":"string","default":"manual"},"csvDocumentId":{"type":"number","default":0},"tableDark":{"type":"boolean","default":false},"tableStriped":{"type":"boolean","default":false},"tableBordered":{"type":"boolean","default":false},"tableBorderless":{"type":"boolean","default":false},"tableHover":{"type":"boolean","default":false},"responsive":{"type":"boolean","default":true},"headerCells":{"type":"array","default":["#","First","Last","Handle"]},"rows":{"type":"array","default":[{"cells":["1","Mark","Otto","@mdo"]},{"cells":["2","Jacob","Thornton","@fat"]},{"cells":["3","Larry the Bird","@twitter",""]}]}},"textdomain":"codeweber-gutenberg-blocks","editorScript":"file:./index.js","editorStyle":"file:./index.css","style":"file:./style-index.css"}'),a=window.React,s=window.wp.blockEditor,c=window.wp.components,d=window.wp.element,i=window.wp.apiFetch;var b=l.n(i);const p=({attributes:e,setAttributes:t})=>{const{sourceMode:l,csvDocumentId:n,tableDark:r,tableStriped:s,tableBordered:i,tableBorderless:p,tableHover:u,responsive:m}=e,[g,w]=(0,d.useState)([]),[v,h]=(0,d.useState)(!1);return(0,d.useEffect)(()=>{"csv"===l&&(h(!0),b()({path:"/codeweber-gutenberg-blocks/v1/documents-csv"}).then(e=>{w(Array.isArray(e)?e:[])}).catch(()=>w([])).finally(()=>h(!1)))},[l]),(0,a.createElement)(a.Fragment,null,(0,a.createElement)(c.PanelBody,{title:(0,o.__)("Data Source","codeweber-gutenberg-blocks"),initialOpen:!0},(0,a.createElement)(c.SelectControl,{label:(0,o.__)("Display mode","codeweber-gutenberg-blocks"),value:l||"manual",options:[{value:"manual",label:(0,o.__)("Manual table","codeweber-gutenberg-blocks")},{value:"csv",label:(0,o.__)("CSV/XLS/XLSX from Documents","codeweber-gutenberg-blocks")}],onChange:e=>t({sourceMode:e,csvDocumentId:"csv"===e?n:0})}),"csv"===l&&(0,a.createElement)(c.SelectControl,{label:(0,o.__)("Document (CSV/XLS/XLSX)","codeweber-gutenberg-blocks"),value:String(n||""),options:[{value:"",label:v?(0,o.__)("Loading…","codeweber-gutenberg-blocks"):(0,o.__)("— Select document —","codeweber-gutenberg-blocks")},...g.map(e=>({value:String(e.id),label:e.title}))],disabled:v,onChange:e=>t({csvDocumentId:e?parseInt(e,10):0})})),(0,a.createElement)(c.PanelBody,{title:(0,o.__)("Table Settings","codeweber-gutenberg-blocks"),className:"custom-panel-body"},(0,a.createElement)("div",{className:"component-sidebar-title"},(0,a.createElement)("label",null,(0,o.__)("Table classes","codeweber-gutenberg-blocks"))),(0,a.createElement)(c.ToggleControl,{label:(0,o.__)("table-dark","codeweber-gutenberg-blocks"),checked:!0===r,onChange:e=>t({tableDark:e})}),(0,a.createElement)(c.ToggleControl,{label:(0,o.__)("table-striped","codeweber-gutenberg-blocks"),checked:!0===s,onChange:e=>t({tableStriped:e})}),(0,a.createElement)(c.ToggleControl,{label:(0,o.__)("table-bordered","codeweber-gutenberg-blocks"),checked:!0===i,onChange:e=>t({tableBordered:e})}),(0,a.createElement)(c.ToggleControl,{label:(0,o.__)("table-borderless","codeweber-gutenberg-blocks"),checked:!0===p,onChange:e=>t({tableBorderless:e})}),(0,a.createElement)(c.ToggleControl,{label:(0,o.__)("table-hover","codeweber-gutenberg-blocks"),checked:!0===u,onChange:e=>t({tableHover:e})}),(0,a.createElement)("div",{style:{marginTop:"16px"}},(0,a.createElement)(c.ToggleControl,{label:(0,o.__)("Responsive","codeweber-gutenberg-blocks"),help:(0,o.__)("Wrap table in table-responsive for horizontal scroll on small screens.","codeweber-gutenberg-blocks"),checked:!0===m,onChange:e=>t({responsive:e})}))))},u=e=>{var t,l,n;return"string"==typeof e?{content:e,colspan:1,rowspan:1}:{content:null!==(t=e?.content)&&void 0!==t?t:"",colspan:Math.max(1,null!==(l=e?.colspan)&&void 0!==l?l:1),rowspan:Math.max(1,null!==(n=e?.rowspan)&&void 0!==n?n:1)}},m=e=>{var t,l,n;return"string"==typeof e?{content:e,colspan:1,rowspan:1}:{content:null!==(t=e?.content)&&void 0!==t?t:"",colspan:Math.max(1,null!==(l=e?.colspan)&&void 0!==l?l:1),rowspan:Math.max(1,null!==(n=e?.rowspan)&&void 0!==n?n:1)}},g={isEligible:e=>void 0!==e.cardWrapper,migrate(e){const{cardWrapper:t,...l}=e;return l}},w={isEligible(e){const t=e.headerCells?.[0];return"string"==typeof t},migrate:e=>({...e,headerCells:(e.headerCells||[]).map(e=>{var t;return"string"==typeof e?{content:e,colspan:1,rowspan:1}:{...e,rowspan:null!==(t=e.rowspan)&&void 0!==t?t:1}}),rows:(e.rows||[]).map(e=>({...e,cells:(e.cells||[]).map(e=>{var t;return"string"==typeof e?{content:e,colspan:1,rowspan:1}:{...e,rowspan:null!==(t=e.rowspan)&&void 0!==t?t:1}})}))})};(0,n.registerBlockType)(r,{edit:({attributes:e,setAttributes:t})=>{const{sourceMode:l,csvDocumentId:n,tableDark:r,tableStriped:i,tableBordered:m,tableBorderless:g,tableHover:w,responsive:v,headerCells:h,rows:k}=e,[f,_]=(0,d.useState)({header:[],rows:[]}),[E,y]=(0,d.useState)(!1);(0,d.useEffect)(()=>{"csv"===l&&n?(y(!0),b()({path:`/codeweber-gutenberg-blocks/v1/documents/${n}/csv`}).then(e=>{_({header:e?.rows?.[0]||[],rows:e?.rows?.slice(1)||[]})}).catch(()=>_({header:[],rows:[]})).finally(()=>y(!1))):_({header:[],rows:[]})},[l,n]);const S=(h||[]).map(u),C=e=>(e?.cells||[]).map(u),x=()=>{const e=["table"];return r&&e.push("table-dark"),i&&e.push("table-striped"),m&&e.push("table-bordered"),g&&e.push("table-borderless"),w&&e.push("table-hover"),e.join(" ")},B=()=>{const e=new Set,t=[];for(let o=0;o<k.length;o++){t[o]=[];const r=C(k[o]);let a=0,s=0;for(;a<N&&s<r.length;){var l,n;if(e.has(`${o}:${a}`)){a++;continue}const c=r[s],d=null!==(l=c.rowspan)&&void 0!==l?l:1,i=null!==(n=c.colspan)&&void 0!==n?n:1;t[o].push({cell:c,colIndex:a,cellIndex:s,rowspan:d,colspan:i});for(let t=1;t<d;t++)for(let l=0;l<i;l++)e.add(`${o+t}:${a+l}`);a+=i,s++}}return{layout:t,covered:e}},I=e=>{const{covered:t}=B();let l=0;for(let n=0;n<N;n++)t.has(`${e}:${n}`)&&l++;return l},N=S.reduce((e,t)=>e+t.colspan,0),T=(0,s.useBlockProps)({className:"wp-block-codeweber-blocks-tables"}),M=(0,a.createElement)("table",{className:x()},(0,a.createElement)("thead",null,(0,a.createElement)("tr",null,S.map((e,l)=>(0,a.createElement)("th",{key:l,scope:"col",colSpan:e.colspan>1?e.colspan:void 0},(0,a.createElement)("div",{className:"tables-cell-controls"},(0,a.createElement)(c.Button,{isSmall:!0,isDestructive:!0,onClick:e=>{e.stopPropagation(),(e=>{S.length<=1||t({headerCells:S.filter((t,l)=>l!==e),rows:k.map(t=>({...t,cells:C(t).filter((t,l)=>l!==e)}))})})(l)},disabled:S.length<=1,title:(0,o.__)("Remove column","codeweber-gutenberg-blocks")},"×"),l<S.length-1&&(0,a.createElement)(c.Button,{isSmall:!0,isSecondary:!0,onClick:e=>{e.stopPropagation(),(e=>{if(e>=S.length-1)return;const l=S.map((t,l)=>{if(l===e){var n;const l=S[e+1];return{content:(t.content+" "+l.content).trim(),colspan:t.colspan+l.colspan,rowspan:null!==(n=t.rowspan)&&void 0!==n?n:1}}return l===e+1?null:t}).filter(Boolean);t({headerCells:l})})(l)},title:(0,o.__)("Merge with next cell","codeweber-gutenberg-blocks")},"⇄"),e.colspan>1&&(0,a.createElement)(c.Button,{isSmall:!0,isSecondary:!0,onClick:e=>{e.stopPropagation(),(e=>{const l=S[e];if(!l||l.colspan<=1)return;const n=[...S.slice(0,e),{content:l.content,colspan:1,rowspan:1},{content:"",colspan:1,rowspan:1},...Array.from({length:l.colspan-2},()=>({content:"",colspan:1,rowspan:1})),...S.slice(e+1)];t({headerCells:n})})(l)},title:(0,o.__)("Split cell","codeweber-gutenberg-blocks")},"⊣")),(0,a.createElement)(s.RichText,{tagName:"span",value:e.content,onChange:e=>((e,l)=>{const n=S.map((t,n)=>n===e?{...t,content:l}:t);t({headerCells:n})})(l,e),placeholder:(0,o.__)("Header…","codeweber-gutenberg-blocks"),withoutInteractiveFormatting:!0}))))),(0,a.createElement)("tbody",null,k.map((e,l)=>{const n=C(e),r=n.reduce((e,t)=>e+t.colspan,0),d=I(l),i=N-d,b=Math.max(0,i-r),{layout:p}=B();return(0,a.createElement)("tr",{key:l,className:"tables-editor-row"},n.map((e,r)=>{var d,i;const b=0===r?"th":"td",u=0===r?{scope:"row"}:{};return(0,a.createElement)(b,{key:r,...u,colSpan:e.colspan>1?e.colspan:void 0,rowSpan:(null!==(d=e.rowspan)&&void 0!==d?d:1)>1?e.rowspan:void 0},0===r&&(0,a.createElement)("span",{className:"tables-row-actions"},(0,a.createElement)(c.Button,{isSmall:!0,isDestructive:!0,onClick:()=>(e=>{k.length<=1||t({rows:k.filter((t,l)=>l!==e)})})(l),disabled:k.length<=1,title:(0,o.__)("Remove row","codeweber-gutenberg-blocks")},"×")),(0,a.createElement)("div",{className:"tables-cell-controls"},r<n.length-1&&(0,a.createElement)(c.Button,{isSmall:!0,isSecondary:!0,onClick:e=>{e.stopPropagation(),((e,l)=>{const n=C(k[e]);if(l>=n.length-1)return;const o=[...k],r=n.map((e,t)=>{if(t===l){var o;const t=n[l+1];return{content:(e.content+" "+t.content).trim(),colspan:e.colspan+t.colspan,rowspan:null!==(o=e.rowspan)&&void 0!==o?o:1}}return t===l+1?null:e}).filter(Boolean);o[e]={...o[e],cells:r},t({rows:o})})(l,r)},title:(0,o.__)("Merge with next cell","codeweber-gutenberg-blocks")},"⇄"),e.colspan>1&&(0,a.createElement)(c.Button,{isSmall:!0,isSecondary:!0,onClick:e=>{e.stopPropagation(),((e,l)=>{const n=C(k[e]),o=n[l];if(!o||o.colspan<=1)return;const r=[...k],a=[...n.slice(0,l),{content:o.content,colspan:1,rowspan:1},{content:"",colspan:1,rowspan:1},...Array.from({length:o.colspan-2},()=>({content:"",colspan:1,rowspan:1})),...n.slice(l+1)];r[e]={...r[e],cells:a},t({rows:r})})(l,r)},title:(0,o.__)("Split cell","codeweber-gutenberg-blocks")},"⊣"),((e,t)=>{if(e>=k.length-1)return!1;const l=p[e]?.find(e=>e.cellIndex===t);if(!l)return!1;const n=p[e+1]?.find(e=>e.colIndex>=l.colIndex&&e.colIndex<l.colIndex+l.colspan);return!!n})(l,r)&&(0,a.createElement)(c.Button,{isSmall:!0,isSecondary:!0,onClick:e=>{e.stopPropagation(),((e,l)=>{var n,o;if(e>=k.length-1)return;const{layout:r}=B(),a=r[e],s=a?.find(e=>e.cellIndex===l);if(!s)return;const{colIndex:c,colspan:d}=s,i=r[e+1],b=i?.find(e=>e.colIndex>=c&&e.colIndex<c+d);if(!b)return;const p=[...k],u=C(p[e]),m=C(p[e+1]),g=u[l],w=m[b.cellIndex],v={content:(g.content+" "+w.content).trim(),colspan:g.colspan,rowspan:(null!==(n=g.rowspan)&&void 0!==n?n:1)+(null!==(o=w.rowspan)&&void 0!==o?o:1)},h=u.map((e,t)=>t===l?v:e),f=m.filter((e,t)=>t!==b.cellIndex);p[e]={...p[e],cells:h},p[e+1]={...p[e+1],cells:f},t({rows:p})})(l,r)},title:(0,o.__)("Merge with cell below","codeweber-gutenberg-blocks")},"⇕"),(null!==(i=e.rowspan)&&void 0!==i?i:1)>1&&(0,a.createElement)(c.Button,{isSmall:!0,isSecondary:!0,onClick:e=>{e.stopPropagation(),((e,l)=>{var n;const o=C(k[e]),r=o[l];if(!r||(null!==(n=r.rowspan)&&void 0!==n?n:1)<=1)return;const a=[...k],s=o.map((e,t)=>t===l?{...e,rowspan:1}:e),{layout:c}=B(),d=c[e+1],i=c[e]?.find(e=>e.cellIndex===l);if(!i||!d)return;const{colIndex:b}=i,p=d.findIndex(e=>e.colIndex>=b),u=-1===p?d.length:p,m=C(a[e+1]),g=[...m.slice(0,u),{content:"",colspan:r.colspan,rowspan:1},...m.slice(u)];a[e]={...a[e],cells:s},a[e+1]={...a[e+1],cells:g},t({rows:a})})(l,r)},title:(0,o.__)("Split cell vertically","codeweber-gutenberg-blocks")},"⊤")),(0,a.createElement)(s.RichText,{tagName:"span",value:e.content,onChange:e=>((e,l,n)=>{const o=[...k],r=[...C(o[e])];for(;r.length<=l;)r.push({content:"",colspan:1,rowspan:1});r[l]={...r[l],content:n},o[e]={...o[e],cells:r},t({rows:o})})(l,r,e),placeholder:(0,o.__)("…","codeweber-gutenberg-blocks"),withoutInteractiveFormatting:!0}))}),b>0&&(0,a.createElement)("td",{colSpan:b},(0,a.createElement)(s.RichText,{tagName:"span",value:"",onChange:e=>((e,l)=>{const n=C(k[e]),o=n.reduce((e,t)=>e+t.colspan,0),r=I(e),a=N-r,s=Math.max(0,a-o);if(s<=0)return;const c=[...k],d=[...n,{content:l,colspan:s,rowspan:1}];c[e]={...c[e],cells:d},t({rows:c})})(l,e),placeholder:"…",withoutInteractiveFormatting:!0})))}))),D="csv"===l,O=(0,a.createElement)("table",{className:x()},(0,a.createElement)("thead",null,(0,a.createElement)("tr",null,f.header.map((e,t)=>(0,a.createElement)("th",{key:t,scope:"col"},String(e))))),(0,a.createElement)("tbody",null,f.rows.map((e,t)=>(0,a.createElement)("tr",{key:t},e.map((e,t)=>(0,a.createElement)("td",{key:t},String(e)))))));return(0,a.createElement)(a.Fragment,null,(0,a.createElement)(s.InspectorControls,null,(0,a.createElement)(p,{attributes:e,setAttributes:t})),(0,a.createElement)("div",{...T},D?(0,a.createElement)(a.Fragment,null,E?(0,a.createElement)("p",null,(0,o.__)("Loading CSV…","codeweber-gutenberg-blocks")):n&&(f.header.length>0||f.rows.length>0)?v?(0,a.createElement)("div",{className:"table-responsive"},O):O:(0,a.createElement)("p",{className:"tables-csv-placeholder"},(0,o.__)("Select a CSV document in the sidebar. Table updates when the document changes.","codeweber-gutenberg-blocks"))):(0,a.createElement)(a.Fragment,null,v?(0,a.createElement)("div",{className:"table-responsive"},M):M,(0,a.createElement)("div",{className:"tables-block-actions"},(0,a.createElement)(c.Button,{isSmall:!0,isSecondary:!0,onClick:()=>{t({headerCells:[...S,{content:(0,o.__)("New","codeweber-gutenberg-blocks"),colspan:1}],rows:k.map(e=>({...e,cells:[...C(e),{content:"",colspan:1}]}))})}},(0,o.__)("+ Add Column","codeweber-gutenberg-blocks")),(0,a.createElement)(c.Button,{isSmall:!0,isSecondary:!0,onClick:()=>{const e=S.map(()=>({content:"",colspan:1,rowspan:1}));t({rows:[...k,{cells:e}]})}},(0,o.__)("+ Add Row","codeweber-gutenberg-blocks"))))))},save:({attributes:e})=>{const{sourceMode:t,tableDark:l,tableStriped:n,tableBordered:o,tableBorderless:r,tableHover:c,responsive:d,headerCells:i,rows:b}=e;if("csv"===t)return null;const p=(i||[]).map(m),u=e=>(e?.cells||[]).map(m),g=p.reduce((e,t)=>e+t.colspan,0),w=s.useBlockProps.save({className:"wp-block-codeweber-blocks-tables"}),v=(0,a.createElement)("table",{className:(()=>{const e=["table"];return l&&e.push("table-dark"),n&&e.push("table-striped"),o&&e.push("table-bordered"),r&&e.push("table-borderless"),c&&e.push("table-hover"),e.join(" ")})()},(0,a.createElement)("thead",null,(0,a.createElement)("tr",null,p.map((e,t)=>(0,a.createElement)("th",{key:t,scope:"col",colSpan:e.colspan>1?e.colspan:void 0},(0,a.createElement)(s.RichText.Content,{value:e.content}))))),(0,a.createElement)("tbody",null,b.map((e,t)=>{const l=u(e),n=l.reduce((e,t)=>e+t.colspan,0),o=(e=>{const t=new Set;for(let e=0;e<b.length;e++){const o=u(b[e]);let r=0,a=0;for(;r<g&&a<o.length;){var l,n;if(t.has(`${e}:${r}`)){r++;continue}const s=o[a],c=null!==(l=s.rowspan)&&void 0!==l?l:1,d=null!==(n=s.colspan)&&void 0!==n?n:1;for(let l=1;l<c;l++)for(let n=0;n<d;n++)t.add(`${e+l}:${r+n}`);r+=d,a++}}let o=0;for(let l=0;l<g;l++)t.has(`${e}:${l}`)&&o++;return o})(t),r=g-o,c=Math.max(0,r-n);return(0,a.createElement)("tr",{key:t},l.map((e,t)=>{var l;const n=0===t?"th":"td",o=0===t?{scope:"row"}:{};return(0,a.createElement)(n,{key:t,...o,colSpan:e.colspan>1?e.colspan:void 0,rowSpan:(null!==(l=e.rowspan)&&void 0!==l?l:1)>1?e.rowspan:void 0},(0,a.createElement)(s.RichText.Content,{value:e.content}))}),c>0&&(0,a.createElement)("td",{key:"pad",colSpan:c}))})));return(0,a.createElement)("div",{...w},d?(0,a.createElement)("div",{className:"table-responsive"},v):v)},deprecated:[g,w,{isEligible:e=>void 0===e.sourceMode,migrate:e=>({...e,sourceMode:"manual",csvDocumentId:0})}],title:(0,o.__)("Tables","codeweber-gutenberg-blocks"),description:(0,o.__)("Bootstrap 5 tables. Supports Simple, Dark, Striped, Bordered, Borderless, Hoverable, and Responsive styles.","codeweber-gutenberg-blocks"),keywords:[(0,o.__)("table","codeweber-gutenberg-blocks"),(0,o.__)("tables","codeweber-gutenberg-blocks"),(0,o.__)("bootstrap","codeweber-gutenberg-blocks"),(0,o.__)("data","codeweber-gutenberg-blocks")]})}},l={};function n(e){var o=l[e];if(void 0!==o)return o.exports;var r=l[e]={exports:{}};return t[e](r,r.exports,n),r.exports}n.m=t,e=[],n.O=(t,l,o,r)=>{if(!l){var a=1/0;for(i=0;i<e.length;i++){for(var[l,o,r]=e[i],s=!0,c=0;c<l.length;c++)(!1&r||a>=r)&&Object.keys(n.O).every(e=>n.O[e](l[c]))?l.splice(c--,1):(s=!1,r<a&&(a=r));if(s){e.splice(i--,1);var d=o();void 0!==d&&(t=d)}}return t}r=r||0;for(var i=e.length;i>0&&e[i-1][2]>r;i--)e[i]=e[i-1];e[i]=[l,o,r]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var l in t)n.o(t,l)&&!n.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={6234:0,9182:0};n.O.j=t=>0===e[t];var t=(t,l)=>{var o,r,[a,s,c]=l,d=0;if(a.some(t=>0!==e[t])){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(c)var i=c(n)}for(t&&t(l);d<a.length;d++)r=a[d],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(i)},l=globalThis.webpackChunkcodeweber_gutenberg_blocks=globalThis.webpackChunkcodeweber_gutenberg_blocks||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))})();var o=n.O(void 0,[9182],()=>n(180));o=n.O(o)})();